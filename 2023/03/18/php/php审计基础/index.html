<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="mayylu">



    <meta name="description" content="学习是一种生活态度">



<title>php审计基础 | mayylu&#39;s blog</title>



    <link rel="icon" href="/vue.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 5.4.0"></head>

<body>
    <script>
        // this function is used to check current theme before page loaded.
        (() => {
            const currentTheme = window.localStorage && window.localStorage.getItem('theme') || '';
            const isDark = currentTheme === 'dark';
            const pagebody = document.getElementsByTagName('body')[0]
            if (isDark) {
                pagebody.classList.add('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Dark"
            } else {
                pagebody.classList.remove('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Light"
            }
        })();
    </script>

    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">mayylu&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/categories">Categories</a>
                
                    <a class="menu-item" href="/tags">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">mayylu&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/categories">Categories</a>
                
                    <a class="menu-item" href="/tags">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
            <div class="main">
                <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    var tocbot_timer;
    var DEPTH_MAX = 6; // 为 6 时展开所有
    var tocbot_default_config = {
        tocSelector: '.tocbot-list',
        contentSelector: '.post-content',
        headingSelector: 'h1, h2, h3, h4, h5',
        orderedList: false,
        scrollSmooth: true,
        onClick: extend_click,
    };

    function extend_click() {
        clearTimeout(tocbot_timer);
        tocbot_timer = setTimeout(function() {
            tocbot.refresh(obj_merge(tocbot_default_config, {
                hasInnerContainers: true
            }));
        }, 420); // 这个值是由 tocbot 源码里定义的 scrollSmoothDuration 得来的
    }

    document.ready(function() {
        tocbot.init(obj_merge(tocbot_default_config, {
            collapseDepth: 1
        }));
    });

    function expand_toc() {
        var b = document.querySelector('.tocbot-toc-expand');
        var expanded = b.getAttribute('data-expanded');
        expanded ? b.removeAttribute('data-expanded') : b.setAttribute('data-expanded', true);
        tocbot.refresh(obj_merge(tocbot_default_config, {
            collapseDepth: expanded ? 1 : DEPTH_MAX
        }));
        b.innerText = expanded ? 'Expand all' : 'Collapse all';
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

    function obj_merge(target, source) {
        for (var item in source) {
            if (source.hasOwnProperty(item)) {
                target[item] = source[item];
            }
        }
        return target;
    }
</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">php审计基础</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">mayylu</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">三月 18, 2023&nbsp;&nbsp;</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/categories/php/">php</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>代码审计,是对应用程序源代码进行系统性检查的工作。 目的是为了找到并且修复应用程序在开发阶段存在的一些漏洞或者程序逻辑错误,避免程序漏洞被非法利用给企业带来不必要的风险.</p>
<span id="more"></span>
<h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><h3 id="phpinfo"><a href="#phpinfo" class="headerlink" title="phpinfo"></a>phpinfo</h3><p>phpinfo(int $flags = INFO_ALL): bool<br>flags:<br>INFO_ALL             -1  显示以上所有信息。(默认)<br>INFO_GENERAL         1     配置的命令行、php.ini 的文件位置、建立的时间、Web 服务器、系统及更多其他信息。<br>INFO_ENVIRONMENT     16     环境变量信息也可以用 $_ENV 获取。<br>INFO_VARIABLES         32     显示所有来自 EGPCS (Environment, GET, POST, Cookie, Server) 的 预定义变量。</p>
<h4 id="phpinfo-函数返回的信息"><a href="#phpinfo-函数返回的信息" class="headerlink" title="phpinfo()函数返回的信息"></a>phpinfo()函数返回的信息</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Core</span><br><span class="line">PHP_VERSION                 php版本号</span><br><span class="line">allow_url_fopen	</span><br><span class="line">allow_url_include</span><br><span class="line">open_basedir                访问限制</span><br><span class="line">disable_functions</span><br><span class="line">upload_tmp_dir              临时目录</span><br><span class="line">Loaded Configuration File   php.ini地址</span><br><span class="line"></span><br><span class="line">PHP Variables</span><br><span class="line">$_SERVER[&#x27;DOCUMENT_ROOT&#x27;]   网站绝对路径</span><br><span class="line">$_SERVER[&#x27;SERVER_SOFTWARE&#x27;] 服务器软件</span><br><span class="line">$_SERVER[&#x27;HTTP_HOST&#x27;]       网站真实ip</span><br><span class="line">$_SERVER[&#x27;PATH_INFO&#x27;]       url访问目录</span><br><span class="line">$_SERVER[&#x27;QUERY_STRING&#x27;] =  url参数</span><br><span class="line">$_SERVER[&#x27;REQUEST_URI&#x27;]     $_SERVER[&#x27;PATH_INFO&#x27;]+$_SERVER[&#x27;QUERY_STRING&#x27;]</span><br></pre></td></tr></table></figure>

<h3 id="php预变量"><a href="#php预变量" class="headerlink" title="php预变量"></a>php预变量</h3><h4 id="常量"><a href="#常量" class="headerlink" title="常量"></a>常量</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">PHP_VERSION     PHP_VERSION</span><br><span class="line">__NAMESPACE__   当前命名空间名称的字符串</span><br><span class="line">__FILE__ 	    文件的完整路径和文件名。</span><br><span class="line">__DIR__ 	    文件所在的目录。等价于 dirname(__FILE__)。目录名不包括末尾的斜杠.</span><br><span class="line">__FUNCTION__ 	当前函数的名称。匿名函数则为 &#123;closure&#125;。</span><br><span class="line">__CLASS__ 	    当前类的名称。</span><br><span class="line">defined(&#x27;FOO&#x27;) or define(&#x27;FOO&#x27;,     &#x27;something&#x27;);||const FOO=&quot;something&quot;;    自定义常量</span><br><span class="line">PHP_OS          运行 PHP 的操作系统</span><br></pre></td></tr></table></figure>
<h4 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">    $_SERVER[&#x27;HTTP_HOST&#x27;]   主机地址</span><br><span class="line"></span><br><span class="line">    $_SERVER[&#x27;PHP_SELF&#x27;]  当前执行脚本的文件名</span><br><span class="line"></span><br><span class="line">　　$_SERVER[&#x27;SERVER_ADDR&#x27;] 当前运行脚本所在的服务器的ip地址。</span><br><span class="line"></span><br><span class="line">　　$_SERVER[&#x27;REQUEST_METHOD&#x27;]  访问页面使用的请求方法；例如，&#x27;GET&#x27;、&#x27;HEAD&#x27;、&#x27;POST&#x27;、&#x27;PUT&#x27;。 </span><br><span class="line"></span><br><span class="line">　　$_SERVER[&#x27;REMOTE_ADDR&#x27;] 正在浏览当前页用户的ip地址。</span><br><span class="line"></span><br><span class="line">    $_SERVER[&#x27;REQUEST_URI&#x27;]  URI 用来指定要访问的页面。例如 “/index.html”。 </span><br><span class="line"></span><br><span class="line">    $_SERVER[&#x27;SCRIPT_FILENAME&#x27;]   当前执行脚本的绝对路径</span><br><span class="line"></span><br><span class="line">除了上面列出的元素之外，PHP 还将使用请求报头中的值创建其它元素，这些条目将命名为 HTTP_ 后跟报头名称，大写且使用下划线而不是连字符。</span><br><span class="line">例如 Accept-Language 报头将作为 $_SERVER[&#x27;HTTP_ACCEPT_LANGUAGE&#x27;] 提供。 </span><br><span class="line">    $_FILES         文件上传变量,此数组的概况在文件上传处</span><br><span class="line"></span><br><span class="line">　　$_COOKIE        通过HTTPCookie传递到脚本的信息。这些是由执行php脚本时，通过setcookie()设置的。</span><br><span class="line"></span><br><span class="line">　　$_SESSION       包含与所有会话变量有关的信息。$_SESSION变量主要应用于会话控制和页面间值的传递。</span><br><span class="line"></span><br><span class="line">    $_ENV           环境变量.读$ip = getenv(&#x27;REMOTE_ADDR&#x27;)，写putenv(&quot;UNIQID=$uniqid&quot;);</span><br><span class="line"></span><br><span class="line">    $_REQUEST       设置request默认以 $_GET，$_POST 和 $_COOKIE 的顺序。即在request数组中post可以覆盖get</span><br><span class="line"></span><br><span class="line">　　$_POST           通过post方法传递的参数信息。</span><br><span class="line"></span><br><span class="line">　　$_GET            通过get方法传递的参数信息。</span><br><span class="line"></span><br><span class="line">    $_GLOBALS        由所有已定义的全局变量组成的数组(数值不受局部变量的干扰)。数组的键就是变量的名字。 </span><br></pre></td></tr></table></figure>
<h3 id="命名空间"><a href="#命名空间" class="headerlink" title="命名空间"></a>命名空间</h3><h4 id="定义命名空间"><a href="#定义命名空间" class="headerlink" title="定义命名空间"></a>定义命名空间</h4><p> PHP 命名空间类似与文件系统，可分为相对命名空间和绝对命名空间</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//file1.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Foo</span>\<span class="title">Bar</span>\<span class="title">subnamespace</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">foo</span></span>&#123;<span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">staticmethod</span>(<span class="params"></span>) </span>&#123;&#125;&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//file2.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">Foo</span>\<span class="title">Bar</span>;</span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;file1.php&#x27;</span>;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">foo</span></span>&#123; <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">staticmethod</span>(<span class="params"></span>) </span>&#123;&#125;&#125;</span><br><span class="line"><span class="comment">/* 非限定名称 */</span></span><br><span class="line">foo::staticmethod(); <span class="comment">// 解析为类 Foo\Bar\foo 的静态方法 staticmethod</span></span><br><span class="line"><span class="comment">/* 限定名称 */</span></span><br><span class="line">subnamespace\foo::staticmethod(); <span class="comment">// 解析为类 Foo\Bar\subnamespace\foo,</span></span><br><span class="line">                                  <span class="comment">// 以及类的方法 staticmethod                           </span></span><br><span class="line"><span class="comment">/* 完全限定名称 */</span></span><br><span class="line">\Foo\Bar\foo::staticmethod(); <span class="comment">// 解析为类 Foo\Bar\foo, 以及类的方法 staticmethod</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="使用命名空间"><a href="#使用命名空间" class="headerlink" title="使用命名空间"></a>使用命名空间</h4><p>use是使用命名空间，相当于java中的导包，前提是包中的文件需要提前require或者include进来</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//导入类</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">Think</span>\<span class="title">Storage</span>;</span><br><span class="line"><span class="comment">//导入类同时起别名</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">My</span>\<span class="title">Full</span>\<span class="title">Classname</span> <span class="title">as</span> <span class="title">Another</span>;</span><br><span class="line"><span class="comment">//导入函数</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">function</span> <span class="title">some</span>\<span class="title">namespace</span>\<span class="title">fn_a</span>;</span><br><span class="line"><span class="comment">//导入常量</span></span><br><span class="line"><span class="keyword">use</span> <span class="title">const</span> <span class="title">some</span>\<span class="title">namespace</span>\<span class="title">ConstA</span>;</span><br></pre></td></tr></table></figure>
<h3 id="自动加载"><a href="#自动加载" class="headerlink" title="自动加载"></a>自动加载</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// function __autoload($class) &#123;</span></span><br><span class="line"><span class="comment">//     include &#x27;classes/&#x27; . $class . &#x27;.class.php&#x27;;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">my_autoloader</span>(<span class="params"><span class="variable">$class</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">include</span> <span class="string">&#x27;classes/&#x27;</span> . <span class="variable">$class</span> . <span class="string">&#x27;.class.php&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">spl_autoload_register(<span class="string">&#x27;my_autoloader&#x27;</span>);</span><br><span class="line"><span class="comment">// 或者可以使用匿名函数</span></span><br><span class="line">spl_autoload_register(<span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$class</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">include</span> <span class="string">&#x27;classes/&#x27;</span> . <span class="variable">$class</span> . <span class="string">&#x27;.class.php&#x27;</span>;</span><br><span class="line">&#125;);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="php反射"><a href="#php反射" class="headerlink" title="php反射"></a>php反射</h3><p>在 PHP 中，反射（Reflection）是一种机制，用于在运行时动态地获取类、接口、函数、方法等的信息。反射机制允许我们在运行时分析和修改代码结构，包括类的属性和方法等。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyClass</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$myProperty</span> = <span class="string">&#x27;hello&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">myMethod</span>(<span class="params"><span class="variable">$param1</span>, <span class="variable">$param2</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;myProperty . <span class="string">&#x27; &#x27;</span> . <span class="variable">$param1</span> . <span class="string">&#x27; &#x27;</span> . <span class="variable">$param2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$reflection</span> = <span class="keyword">new</span> ReflectionClass(<span class="string">&#x27;MyClass&#x27;</span>);<span class="comment">//使用 ReflectionClass 类来获取 MyClass 类的反射对象 </span></span><br><span class="line"></span><br><span class="line"><span class="variable">$property</span> = <span class="variable">$reflection</span>-&gt;getProperty(<span class="string">&#x27;myProperty&#x27;</span>);<span class="comment">//getProperty() 方法来获取 $myProperty 属性的反射对象</span></span><br><span class="line"><span class="variable">$property</span>-&gt;setAccessible(<span class="literal">true</span>);<span class="comment">//使用 setAccessible() 方法将其设为可访问</span></span><br><span class="line"><span class="variable">$property</span>-&gt;setValue(<span class="keyword">new</span> MyClass(), <span class="string">&#x27;world&#x27;</span>);<span class="comment">//使用 setValue() 方法修改了 $myProperty 的值为 world</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$constructor</span> = <span class="variable">$reflect</span>-&gt;getConstructor();<span class="comment">// 一个 ReflectionMethod 对象，反射了类的构造函数，或者当类不存在构造函数时返回 null。 </span></span><br><span class="line"><span class="variable">$constructor</span>-&gt;getNumberOfParameters()<span class="comment">//以数组的形式返回参数列表。顺序为源码中定义的顺序。 </span></span><br><span class="line"></span><br><span class="line"><span class="variable">$method</span> = ReflectionMethod(<span class="string">&quot;MyClass&quot;</span>, <span class="string">&quot;myMethod&quot;</span>);<span class="comment">// objectOrMethod 包含方法的类名或者对象（类的实例）。method方法名。</span></span><br><span class="line"><span class="variable">$method</span>-&gt;invokeArgs(<span class="variable">$object</span>,<span class="variable">$args</span>);<span class="comment">//将参数作为数组传递给函数，object调用方法的对象，如果是静态对象，设置为 null,args使用 array 传送的方法参数。</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="回调"><a href="#回调" class="headerlink" title="回调"></a>回调</h3><p>如果你把函数的指针（地址）作为参数传递给另一个函数，当这个指针被用来调用其所指向的函数时，就说这是回调函数。能够降低系统的复杂度，提高代码的可维护性。</p>
<h4 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h4><p>is_callable 验证值是否可以在当前范围内作为函数调用。</p>
<h3 id="PHP的url解析特性"><a href="#PHP的url解析特性" class="headerlink" title="PHP的url解析特性"></a>PHP的url解析特性</h3><p>在php中””包裹的字符串是可以被进一步解析的，例<code>echo(&quot;$_GET[a]&quot;);</code>，而’’包裹的字符串则不能，PHP的url参数的值可视为包裹在””的字符串</p>
<ol>
<li>查询字符串解析<br>值得注意的是，查询字符串在解析的过程中会将某些字符删除或用下划线代替。例如，<code>/?%20news[id%00=42会转换为Array([news_id] =&gt; 42)</code>。</li>
</ol>
<p><img src="https://cdn.jsdelivr.net/gh/mayylu/pic@main/blogs/1567560448_5d6f13004035f.png" alt="1567560448_5d6f13004035f"></p>
<p><code>[</code>会与<code>\</code>匹配(匹配遵循就进原则)没有匹配上的<code>[</code>不会被转义，即匹配成功就不会进行第二次替换，所以可以利用<code>[</code>传入含有特殊字符的变量,如<code>/?my[secret.flag=123</code>=<code>my.secret.flag</code><br>2. <code>$_SERVER[&#39;QUERY_STRING&#39;]</code><br><code>$_SERVER[&#39;QUERY_STRING&#39;]</code>提取?后的内容不会进行URL解码，而<code>$_GET</code>和<code>$_REQUEST</code>解析url时会先进行URL解码,可以进行URL编码绕过</p>
<ol start="3">
<li><p><code>$_REQUEST</code><br>$_REQUEST在同时接收GET和POST参数时，POST优先级更高，优先接受post参数。</p>
</li>
<li><p>basename函数</p>
<pre><code> basename() 函数返回路径中的文件名部分
 basename()不能识别ascii值为`47、128-255`的字符

 http://localhost/?file=%ffindex.php/%ff
 //index.php
 http://localhost/?file=%ffindex.php
 //index.php
 http://localhost/?file=index.php%ff
 //index.php

 &lt;?php
 $path = &quot;/testweb/home.php&quot;;

 //显示带有文件扩展名的文件名
 echo basename($path);

 //显示不带有文件扩展名的文件名
 echo basename($path,&quot;.php&quot;);
 ?&gt; 
 home.php
 home
</code></pre>
</li>
</ol>
<h2 id="php进阶"><a href="#php进阶" class="headerlink" title="php进阶"></a>php进阶</h2><h3 id="PDO"><a href="#PDO" class="headerlink" title="PDO"></a>PDO</h3><p>PDO (PHP Data Objects) 是PHP的一种数据库扩展，PDO使用的是面向对象的编程风格，php5之后自带PDO，它有以下‘好处’：</p>
<ol>
<li>支持不同数据库</li>
<li>预处理语使用PDO预处理语句来执行数据库操作可以避免SQL注入的风险<br>PDO会对传入的每个参数进行转义和类型转换(如果传入的参数是字符串类型，但数据库需要的是整型，PDO会将字符串转换成整型，以确保数据类型的正确性)<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><h4 id="PDO-预处理"><a href="#PDO-预处理" class="headerlink" title="PDO 预处理"></a>PDO 预处理</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 发送预处理指令</span></span><br><span class="line"><span class="variable">$stmt</span>=<span class="variable">$pdo</span>-&gt;prepare(<span class="variable">$pre_sql</span>);<span class="comment">//返回PDOStatement对象</span></span><br><span class="line"><span class="comment">// 捆绑值</span></span><br><span class="line"><span class="variable">$stmt</span>-&gt;bindValue(<span class="string">&#x27;:id&#x27;</span>,<span class="variable">$id</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//绑定变量</span></span><br><span class="line"><span class="variable">$stmt</span>-&gt;bindParam(<span class="string">&#x27;:id&#x27;</span>,<span class="variable">$id</span>);<span class="comment">//占位符的占位符(狗头)</span></span><br><span class="line"><span class="comment">//执行</span></span><br><span class="line"><span class="variable">$stmt</span>-&gt;execute();</span><br><span class="line"><span class="comment">//# 查结果</span></span><br><span class="line"><span class="comment">//PDOStatement::fetch — 从结果集中获取下一行 </span></span><br><span class="line"><span class="variable">$data</span>=<span class="variable">$stmt</span>-&gt;fetchall(PDO::FETCH_ASSOC);</span><br><span class="line"><span class="comment">//PDO::FETCH_ASSOC：返回一个索引为结果集列名的数组</span></span><br><span class="line"><span class="comment">//PDO::FETCH_BOTH（默认）：返回一个索引为结果集列名和以0开始的列号的数组 </span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="绕过"><a href="#绕过" class="headerlink" title="绕过"></a>绕过</h2></li>
</ol>
<h3 id="md5绕过"><a href="#md5绕过" class="headerlink" title="md5绕过"></a>md5绕过</h3><ol>
<li><p>md5的弱比较绕过<br>0e开头且e后为数字可以被解析成科学计数法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">这里附上常见的0E开头的MD5</span><br><span class="line">0e开头的md5和原值：</span><br><span class="line">QNKCDZO</span><br><span class="line">0e830400451993494058024219903391</span><br><span class="line">240610708</span><br><span class="line">0e462097431906509019562988736854</span><br><span class="line">s1091221200a</span><br><span class="line">0e940624217856561557816327384675</span><br><span class="line">s1836677006a</span><br><span class="line">0e481036490867661113260034900752</span><br><span class="line">s532378020a</span><br><span class="line">0e220463095855511507588041205815</span><br><span class="line">s1665632922a</span><br><span class="line">0e731198061491163073197128363787</span><br><span class="line">s1184209335a</span><br><span class="line">0e072485820392773389523109082030</span><br><span class="line">s1885207154a</span><br><span class="line">0e509367213418206700842008763514</span><br><span class="line">s155964671a</span><br><span class="line">0e342768416822451524974117254469</span><br><span class="line">s1502113478a</span><br><span class="line">0e861580163291561247404381396064</span><br><span class="line">s214587387a</span><br><span class="line">0e848240448830537924465865611904</span><br><span class="line">s878926199a</span><br><span class="line">0e545993274517709034328855841020</span><br><span class="line">0e215962017</span><br><span class="line">0e291242476940776845150308577824</span><br></pre></td></tr></table></figure></li>
<li><p>md5的强比较绕过<br>强类型比较(===),判断内容的基础上,还会判断类型是否相同<br>但md5不能加密数组,传入数组会报错,但会继续执行并且返回结果为null，所以md5加密后的结果是下面这样<code>null===null</code>,结果返回true</p>
</li>
<li><p>MD5碰撞<br>MD5碰撞也叫哈希碰撞,是指两个不同内容的输入,经过散列算法后,得到相同的输出,也就是两个不同的值的散列值相同</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">md5</span><br><span class="line">a=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%00%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1U%5D%83%60%FB_%07%FE%A2&amp;b=M%C9h%FF%0E%E3%5C%20%95r%D4w%7Br%15%87%D3o%A7%B2%1B%DCV%B7J%3D%C0x%3E%7B%95%18%AF%BF%A2%02%A8%28K%F3n%8EKU%B3_Bu%93%D8Igm%A0%D1%D5%5D%83%60%FB_%07%FE%A2</span><br><span class="line"></span><br><span class="line">！！！! !注意写题时抓包修改，不要使用HackBar插件</span><br><span class="line"></span><br><span class="line">sha1</span><br><span class="line">a=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr/%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1</span><br><span class="line">b=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2/%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1</span><br></pre></td></tr></table></figure></li>
<li><p>md5($pass,true)的绕过<br>string    必需。要计算的字符串。<br>raw    默认不写为FALSE：32位16进制的字符串，TRUE：16位原始二进制格式的字符串</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">content: ffifdyop</span><br><span class="line">hex: 276f722736c95d99e921722cf9ed621c</span><br><span class="line">raw: &#x27;or&#x27;6\xc9]\x99\xe9!r,\xf9\xedb\x1c</span><br><span class="line">string: &#x27;or&#x27;6]!r,b</span><br><span class="line"></span><br><span class="line">content: 129581926211651571912466741651878684928</span><br><span class="line">hex: 06da5430449f8f6f23dfc1276f722738</span><br><span class="line">raw: \x06\xdaT0D\x9f\x8fo#\xdf\xc1&#x27;or&#x27;8</span><br><span class="line">string: T0Do#&#x27;or&#x27;8</span><br></pre></td></tr></table></figure>
<p>在mysql里面，在用作布尔型判断时,以数字开头的字符串会被当做整型数，那么返回值也是true。</p>
<h3 id="字符串检测绕过"><a href="#字符串检测绕过" class="headerlink" title="字符串检测绕过"></a>字符串检测绕过</h3></li>
<li><p>strcmp() 函数比较两个字符串(适用5.3版本以前的php)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$str１ = &quot;aixuexiwang.com&quot;；</span><br><span class="line">$str２ = &quot;aixuexiwang.com&quot;；</span><br><span class="line">$str３ = &quot;aixuexiwang&quot;；</span><br><span class="line">echo　strcmp($str１，$str2)；　　//输出结果为0，因为，两个字符串相等。</span><br><span class="line">echo　strcmp($str１，$str３)；　　//输出结果为4，因为，参数１比参数２，多了４个字符。</span><br><span class="line">echo　strcmp($str3，$str１)；　　//输出结果为-4，因为，参数１比参数２少了４个字符。</span><br><span class="line"></span><br><span class="line">$str4 = &quot;abc&quot;；</span><br><span class="line">$str5 = &quot;ABC&quot;；</span><br><span class="line">echo　strcmp($str4，$str5)；　　//输出结果为1，因为，区分大小写。</span><br><span class="line">echo　strcmp($str5，$str4)；　　//输出结果为－1，因为，区分大小写。</span><br><span class="line">echo　strcasecmp($str4，$str5)；　　//输出结果为0，因为，不区分大小写，所以，相等。</span><br></pre></td></tr></table></figure>
<p>strcmp()在比较字符串和数组的时候直接返回0，可用于绕过。</p>
</li>
</ol>
<p>ereg()与strpos()两个函数同样不能用数组作为参数，否则返回<strong>NULL</strong>。<br>2. ereg()类似于preg_match但发现模式会返回true，否则返回false(PHP 5.3后已弃用)<br>eregi函数还可以使用%00来进行截断匹配<br>3. strpos() f函数查找字符串在另一字符串中第一次出现的位置（区分大小写）,如果没有找到字符串则返回 FALSE(字符串位置从 0 开始，不是从 1 开始。)<br>相关函数：<br>strrpos() - 查找字符串在另一字符串中最后一次出现的位置（区分大小写）<br>stripos() - 查找字符串在另一字符串中第一次出现的位置（不区分大小写）<br>strripos() -查找字符串在另一字符串中最后一次出现的位置（不区分大小写）</p>
<ol start="4">
<li>preg_match绕过<br>preg_match(返回 pattern 的匹配结果，<strong>0</strong> （不匹配）或 <strong>1</strong>或<strong>false</strong>)<br>preg_match_all(所有匹配 pattern 给定正则表达式的匹配结果并且将它们以 flag 指定顺序输出到$array数组中,返回值为完整匹配次数，输出的 $array 数组中，$array[0]保存完整模式的所有匹配, $array[1] 保存第一个子组的所有匹配)作用相当于python中的re.findall()</li>
</ol>
<p>如果检查为if(preg_match(‘/…/‘, $json)),不管preg_match返回<strong>0</strong>还是<strong>false</strong>，if都不成立</p>
<ul>
<li><p>数组绕过<br>preg_match只能处理字符串，当传入的subject是数组时会返回<strong>false</strong></p>
</li>
<li><p>在非多行模式(没有m修饰符)利用%0a绕过</p>
</li>
</ul>
<p>非多行模式下，preg_match只能识别<strong>一行</strong><br>如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">if (preg_match(&#x27;/^.*(flag).*/&#x27;, $json)) &#123;</span><br><span class="line">    echo &#x27;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#x27;;</span><br><span class="line">&#125;</span><br><span class="line">$json=&quot;%0aflag&quot;   只检测%0a</span><br><span class="line"></span><br><span class="line">if (preg_match(&#x27;/^.*([\x00-\x1F]+).*([\x00-\x1F]+).*$/&#x27;, $json)) &#123;</span><br><span class="line">    echo &#x27;Hacking attempt detected&lt;br/&gt;&lt;br/&gt;&#x27;;</span><br><span class="line">  &#125;</span><br><span class="line">cmd=%0A&#123;%0A&quot;cmd&quot;:&quot;/bin/cat /home/rceservice/flag&quot;%0A&#125;    $对%0A不敏感，若%0A后没有&#x27;&#125;&#x27;,则为一行，有则为两行。当匹配两行时,/^...$/无法匹配成功</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<ul>
<li>利用PCRE回溯次数限制绕过(只能post)<br>膜拜大佬<a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html?page=2#reply-list">https://www.leavesongs.com/PENETRATION/use-pcre-backtrack-limit-to-bypass-restrict.html?page=2#reply-list</a><br>DFA: 从起始状态开始，一个字符一个字符地读取输入串，并根据正则来一步步确定至下一个转移状态，直到匹配不上或走完整个输入<br>由于NFA的执行过程存在回溯，所以其性能会劣于DFA，但它支持更多功能。大多数程序语言都使用了NFA作为正则引擎，其中也包括PHP使用的PCRE库。</li>
</ul>
<p>PHP为了防止正则表达式的拒绝服务攻击（reDOS），给pcre设定了一个回溯次数上限pcre.backtrack_limit=1000000,超过10万次回溯就会返回false<br>一· 贪婪的.*<br><img src="https://cdn.jsdelivr.net/gh/mayylu/pic@main/blogs/51bfc7bb-fd9a-402e-971a-a2247b226f3d.3adc35af4c1d.png" alt="51bfc7bb-fd9a-402e-971a-a2247b226f3d.3adc35af4c1d"><br>.*匹配剩余的所以字符,但正则后续要匹配，就会触发回溯</p>
<p>二. 懒惰的.+?</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/UNION.+?SELECT/is&#x27;</span>, <span class="variable">$input</span>)) &#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&#x27;SQL Injection&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//用union/*aa....*/selsect绕过</span></span><br></pre></td></tr></table></figure>
<ol start="5">
<li>str_replace函数绕过</li>
<li>intval() 函数用于获取变量的整数值<br>成功时返回 var 的 integer 值，失败时返回 0。 空的 array 返回 0，非空的 array 返回 1。</li>
</ol>
<p>最大的值取决于操作系统。 32 位系统最大带符号的 integer 范围是 -2147483648 到 2147483647(2的31次方)。<br>举例：在这样的系统上， intval(‘1000000000000’) ,只取后31位会返回 2147483647。<br>64 位系统上，最大带符号的 integer 值是 9223372036854775807。</p>
<p>字符串有可能返回 0，虽然取决于字符串最左侧的字符。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">echo intval(0x1A);                    // 0x表示16进制，转化为十进制为26</span><br><span class="line">echo intval(0b100);                   // 0b表示2进制，转换为十进制为4</span><br><span class="line">echo intval(12^10);                   // 按位异或(0b1100^0b1010) 0b0110  6</span><br><span class="line">echo intval(12|10);                   // 按位或  (0b1100|0b1010) 1110   14 </span><br><span class="line">echo intval(12&amp;10);                   // 按位和  (0b1100&amp;0b1010) 1000    8</span><br><span class="line">echo intval(~~100);                   // 100</span><br><span class="line">echo intval(1&lt;&lt;2);                    // 左移乘二</span><br><span class="line">echo intval(42000000);                // 42000000</span><br><span class="line">echo intval(&#x27;42000000000000000000&#x27;);  // 利用int的取值范围,5106511852580896768</span><br><span class="line">echo intval(1e10);                    // 10000000000</span><br><span class="line">echo intval(&#x27;1e10&#x27;);                  // 1</span><br><span class="line">echo intval(&quot;1000&quot;);                  // 1000</span><br><span class="line">echo intval(&#x27;10ab&#x27;);                  // 10</span><br><span class="line">echo intval(100*10);                  // 1000</span><br><span class="line">echo intval(&#x27;100*10&#x27;);                // 100</span><br><span class="line">echo intval(42);                      // 42</span><br><span class="line">echo intval(4.2);                     // 4</span><br><span class="line">echo intval(&#x27;42&#x27;);                    // 42</span><br><span class="line">echo intval(&#x27;+42&#x27;);                   // 42</span><br><span class="line">echo intval(&#x27;-42&#x27;);                   // -42</span><br><span class="line">echo intval(042);                     // 34</span><br><span class="line">echo intval(&#x27;042&#x27;);                   // 42</span><br><span class="line">echo intval(42, 8);                   // 42</span><br><span class="line">echo intval(&#x27;42&#x27;, 8);                 // 34</span><br><span class="line">echo intval(array());                 // 0</span><br><span class="line">echo intval(array(&#x27;foo&#x27;, &#x27;bar&#x27;));     // 1</span><br></pre></td></tr></table></figure>


<h2 id="利用"><a href="#利用" class="headerlink" title="利用"></a>利用</h2><h3 id="查看信息"><a href="#查看信息" class="headerlink" title="查看信息"></a>查看信息</h3><pre><code>get_defined_vars() 函数返回作用域内所有已定义的变量、环境变量、服务器变量、用户定义变量列表。 
phpinfo() 输出关于php配置的信息
getenv() 获取一个环境变量的值
get_current_user() 获取当前php脚本所有者的名称
getlastmod() 获取页面最后修改的时间
ini_get() 获取一个配置选项的值
glob() 寻找与模式匹配的文件路径
</code></pre>
<h3 id="为变量赋值"><a href="#为变量赋值" class="headerlink" title="为变量赋值"></a>为变量赋值</h3><ol>
<li><p><strong>file_get_contents</strong>()函数将整个文件读入一个字符串中,并返回这个值，我们也可以利用<code>php://input</code>或<code>data://text/plain,</code>自定义参数值</p>
</li>
<li><p><strong>extract</strong>()函数：从数组中将变量导入当前符号表。<br>定义：<br>从数组中将变量导入到当前的符号表<br>该函数使用数组键名作为变量名，使用数组键值作为变量值。针对数组中的每个元素，将在当前符号表中创建对应的一个变量<br>语法：extract(array,extract_rules,prefix),array,必需，要使用的数组</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$a=&quot;hello&quot;;</span><br><span class="line">$b= array(&#x27;a&#x27; =&gt;&quot;world&quot; ,&quot;b&quot;=&gt;&quot;gogogo&quot;);</span><br><span class="line">extract($b);</span><br><span class="line">echo $a;		//world</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>如上所示，会存在一个覆盖漏洞。</p>
</li>
</ol>
<h3 id="SSRF的危险函数"><a href="#SSRF的危险函数" class="headerlink" title="SSRF的危险函数"></a>SSRF的危险函数</h3><pre><code>file_get_contents()
fsockopen()
curl_exec()
fopen()
readfile()
</code></pre>

        </div>

        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/php/"># php</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
                <a class="prev" rel="prev" href="/2023/04/13/misc/git%20%E5%AE%9E%E8%B7%B5/">git 实践</a>
            
            
            <a class="next" rel="next" href="/2023/02/18/common/web%E6%9C%8D%E5%8A%A1%E4%B8%AD%E7%9A%84%E6%95%B0%E6%8D%AE%E4%BA%A4%E6%8D%A2/">web服务中的数据交换</a>
            
        </section>


    </article>
</div>

            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <span>© mayylu | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>

</html>